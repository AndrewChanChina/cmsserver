<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<title></title>
<link href="./css/admin.css" rel="stylesheet" type="text/css"/>
<link href="./css/theme.css" rel="stylesheet" type="text/css"/>
<link href="./css/jquery.validate.css" rel="stylesheet" type="text/css"/>
<link href="./css/jquery.treeview.css" rel="stylesheet" type="text/css"/>
<link href="./css/jquery.ui.css" rel="stylesheet" type="text/css"/>

<script src="./js/fckeditor.js" type="text/javascript"></script>
<script src="./js/WdatePicker.js" type="text/javascript"></script>
<script src="./js/jquery.js" type="text/javascript"></script>
<script src="./js/jquery.ext.js" type="text/javascript"></script>
<script src="./js/pony.js" type="text/javascript"></script>
<script src="./js/admin.js" type="text/javascript"></script>
<script src="./swfupload/swfupload.js" type="text/javascript"></script>
<script src="./swfupload/swfupload.queue.js" type="text/javascript"></script>
<script src="./swfupload/fileprogress.js" type="text/javascript"></script>
<script src="./swfupload/handlers.js" type="text/javascript"></script>
<link href="./swfupload/process.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
function getTableForm() {
	return document.getElementById("tableForm");
}
function optDelete() {
	if(Pn.checkedCount("names")<=0) {
		alert("请选择您要操作的数据");
		return;
	}
	if(!confirm("您确定删除吗？")) {
		return;
	}
	var f = getTableForm();
	f.action="o_delete.do";
	f.submit();
}
var swfu;
window.onload=function() {
	var uploadUrl = "o_swfupload.do";
	//在firefox、chrome下，上传不能保留登录信息，所以必须加上jsessionid。
	var jsessionid = $.cookie("JSESSIONID");
	if(jsessionid) {
		uploadUrl += ";jsessionid="+jsessionid;
	}
	swfu=new SWFUpload({
		upload_url : uploadUrl,
		flash_url : "/jeecms/thirdparty/swfupload/swfupload.swf",
		file_size_limit : "1000 MB",
		post_params: {"root" : "/r/cms/www"},
		file_types : "*.*",
		file_types_description : "All Files",
		file_queue_limit : 0,
		custom_settings : {
			progressTarget : "fsUploadProgress",
			cancelButtonId : "btnCancel"
		},
		debug: false,
		
		button_image_url : "/jeecms/thirdparty/swfupload/button_notext.png",
		button_placeholder_id : "spanButtonPlaceHolder",
		button_text: "&nbsp;上传文件",
		button_width: 61,
		button_height: 22,
		
		file_queued_handler : fileQueued,
		file_queue_error_handler : fileQueueError,
		file_dialog_complete_handler : fileDialogComplete,
		upload_start_handler : uploadStart,
		upload_progress_handler : uploadProgress,
		upload_error_handler : uploadError,
		upload_success_handler : uploadSuccess,
		upload_complete_handler : uploadComplete,
		queue_complete_handler : queueComplete2
	});
};
function queueComplete2(numFilesUploaded) {
	//刷新页面
	location.href="v_list.do?root=/r/cms/www";
}
var max=300;
function showImage(a) {
	var img = $("<img src='"+ a.href +"' style='border:1px solid #ccc;'/>");
	var imgDiv = $("#sd").append(img);	
	imgDiv.show();
	
	var	width = img.attr("width");
	var	height = img.attr("height");
	if(width>=height&&width>max) {
		height = height*max/width;
		width = max;
	} else if(height>=width||height>max) {
		width = width*max/height;
		height = max;
	}
	var offset = $(a).offset();
	imgDiv.css("left",offset.left+$(a).outerWidth()+3);	
	var buttom = $(window).height()+$(document).scrollTop()-max-offset.top;
	if(buttom<0) {
		imgDiv.css("top",offset.top+buttom-3);
	} else {
		imgDiv.css("top",offset.top-3);
	}
	img.width(width);
	img.height(height);
}
function hideImage(a) {
	$("#sd").empty().hide();
}
</script>
</head>
<body>
<div id="sd" style="display:none;position:absolute;height:300px;width:300px"></div>
<div class="body-box">
<div class="rhead">
	<div class="rpos">当前位置: 资源管理 - 列表</div>
	<form class="ropt">
		<input type="hidden" name="root" value="/r/cms/www"/>
		<input type="submit" value="创建文件" onclick="this.form.action='v_add.do';"/>
	</form>
	<div class="clear"></div>
</div>
<form method="post" enctype="multipart/form-data">
<input type="hidden" name="root" value="/r/cms/www"/>
<table border="0" style="padding-top:3px">
<tr>
	<td>当前目录: /r/cms/www</td>
	<td width="70" align="center"><span id="spanButtonPlaceHolder"></span></td>
	<td><input id="btnCancel" type="button" value="取消" onclick="swfu.cancelQueue();" disabled="disabled" /></td>
	<td>
&nbsp;	新建目录: <input type="text" name="dirName" size="10" onkeypress="if(event.keyCode==13){$('#dirButton').click();return false;}"/>
		<input id="dirButton" type="submit" value="新建" onclick="this.form.method='post';this.form.action='o_create_dir.do';"/>
	</td>
</tr>
<tr><td colspan="4"><div id="fsUploadProgress"></div></td></tr>
</table>
</form>
<form id="tableForm" method="post">
<input type="hidden" name="root" value="/r/cms/www"/>
<table class="pn-ltable" style="" width="100%" cellspacing="1" cellpadding="0" border="0">
<thead class="pn-lthead"><tr>
	<th width="20"><input type='checkbox' onclick='Pn.checkbox("names",this.checked)'/></th>
	<th width="20"> </th>
	<th>文件名</th>
	<th>大小</th>
	<th>最后修改时间</th>
	<th>操作选项</th></tr></thead>
<tbody  class="pn-ltbody"><tr>
	<td><input type="checkbox" name="names" value="/r/cms/www/red"/></td>
	<td align="center"><img src="/jeecms/res/common/img/file/folder.gif"/></td>
	<td>		<a href="v_list.do?root=/r/cms/www/red">red</a>
</td>
	<td align="right">1 KB</td>
	<td align="center">2011-04-06 12:39:33</td>
	<td align="center">		<a href="v_rename.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fred" class="pn-opt">重命名</a> | 		<a disabled="disabled">修改</a> | <a href="o_delete_single.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fred" onclick="if(!confirm('您确定删除吗？')) {return false;}" class="pn-opt">删除</a></td>
</tr>
<tr>
	<td><input type="checkbox" name="names" value="/r/cms/www/sss"/></td>
	<td align="center"><img src="/jeecms/res/common/img/file/folder.gif"/></td>
	<td>		<a href="v_list.do?root=/r/cms/www/sss">sss</a>
</td>
	<td align="right">1 KB</td>
	<td align="center">2011-04-06 17:52:01</td>
	<td align="center">		<a href="v_rename.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fsss" class="pn-opt">重命名</a> | 		<a disabled="disabled">修改</a> | <a href="o_delete_single.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fsss" onclick="if(!confirm('您确定删除吗？')) {return false;}" class="pn-opt">删除</a></td>
</tr>
<tr>
	<td><input type="checkbox" name="names" value="/r/cms/www/no_picture.gif"/></td>
	<td align="center"><img src="/jeecms/res/common/img/file/gif.gif"/></td>
	<td>		<a href="/jeecms/r/cms/www/no_picture.gif" onmouseover="showImage(this)" onmouseout="hideImage(this)" target="_blank">no_picture.gif</a>
</td>
	<td align="right">4 KB</td>
	<td align="center">2011-02-17 09:24:40</td>
	<td align="center">		<a href="v_rename.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fno_picture.gif" class="pn-opt">重命名</a> | 		<a disabled="disabled">修改</a> | <a href="o_delete_single.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fno_picture.gif" onclick="if(!confirm('您确定删除吗？')) {return false;}" class="pn-opt">删除</a></td>
</tr>
<tr>
	<td><input type="checkbox" name="names" value="/r/cms/www/watermark.png"/></td>
	<td align="center"><img src="/jeecms/res/common/img/file/png.gif"/></td>
	<td>		<a href="/jeecms/r/cms/www/watermark.png" onmouseover="showImage(this)" onmouseout="hideImage(this)" target="_blank">watermark.png</a>
</td>
	<td align="right">22 KB</td>
	<td align="center">2011-02-17 09:24:40</td>
	<td align="center">		<a href="v_rename.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fwatermark.png" class="pn-opt">重命名</a> | 		<a disabled="disabled">修改</a> | <a href="o_delete_single.do?root=%2Fr%2Fcms%2Fwww&name=%2Fr%2Fcms%2Fwww%2Fwatermark.png" onclick="if(!confirm('您确定删除吗？')) {return false;}" class="pn-opt">删除</a></td>
</tr></tbody>
</table>
<div>
	<input type="button" value="删除" onclick="optDelete();"/>
</div>
</form>
</div>
</body>
</html>